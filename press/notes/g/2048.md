---
date: 2023/3/17
title: '2048'
category: 练习
tags:
  - 小游戏
---

多年前，我在初学编程时曾用 cocos 引擎做过（🐶 "cv" 大法）一版 "2048" 游戏，不过由于保管不善，那时写的代码都找不到了。这里我用 vue 重新实现了一版。

## 试玩

> 使用键盘方向键或者触屏滑动来移动方块

## 日志

"2048" 的玩法非常简单，玩家基本不需要看游戏说明就可以快速上手。  
不过在实现的过程中我也遇到了不少问题。其中，关键点在于如何实现方块的移动逻辑。

### 移动逻辑

为了方便描述，我们可以用一个四元组来表示某一行（列）方格数字（假设数字 **0** 表示空位），  
根据 [gabrielecirulli-2048](https://github.com/gabrielecirulli/2048) 分享的版本，我在试玩后记录了如下几组数据：

> 注：移动方式均为向右 👉 移动

| 序号 | 移动前      | 移动后      |
| :--: | :---------- | :---------- |
|  1   | **2 0 2 0** | **0 0 0 4** |
|  2   | **2 2 4 4** | **0 0 4 8** |
|  3   | **2 2 4 8** | **0 4 4 8** |
|  4   | **2 2 2 0** | **0 0 2 4** |

- 前 2 组很容易理解，相邻（中间允许有空位）的两个数字如果相等就合并，然后尽可能往右填满空位
- 第 3 组的结果不是 **0 0 8 8** ，推测已经合并过的格子，不能继续参与本轮后续合并了
- 第 4 组的结果不是 **0 0 4 2** ，这个合成的优先顺序需要注意一下

到这里问题就转变成实现一个转换函数：输入移动前的四元组和移动方向，输出移动后的四元组。  
另外考虑到四个方向移动的对称性，我们只需要实现一个方向的逻辑，就可以依葫芦画瓢推广到其它三个方向上。

最后我采用了一个直观粗暴的方法：根据移动前空位数量情况（可能是 0、1、2、3、4 其中之一）来进行分类处理。不过这种方法的缺点就是不够灵活，一旦地图变成非 4 \* 4 的方格，就需要重新设计算法。

### AI

🤔 如何实现让电脑自己玩，且能有可能合成出 2048 呢 ？挖坑待填...

## 参考链接

- [gabrielecirulli-2048 | github](https://github.com/gabrielecirulli/2048)： 文中提到的试玩版本，据说是最早的 "2048" Web 版本
- [2048 | wiki](<https://en.wikipedia.org/wiki/2048_(video_game)>)
